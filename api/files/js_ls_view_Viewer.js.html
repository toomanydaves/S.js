<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js&#x2F;ls&#x2F;view&#x2F;Viewer.js - LearnShip JS API</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="&#x2F;images&#x2F;api&#x2F;logo.png" title="LearnShip JS API"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/ui.Dropdown.html">ui.Dropdown</a></li>
            
                <li><a href="..&#x2F;classes/view.Path.html">view.Path</a></li>
            
                <li><a href="..&#x2F;classes/view.Viewer.html">view.Viewer</a></li>
            
                <li><a href="..&#x2F;classes/view.Viewport.html">view.Viewport</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/ui.html">ui</a></li>
            
                <li><a href="..&#x2F;modules/view.html">view</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: js&#x2F;ls&#x2F;view&#x2F;Viewer.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 * The View module is responsible for the user interface of the application.
 * @module view
 *&#x2F;
define(
    [ &#x27;jquery&#x27;, &#x27;utility&#x2F;jquery.step&#x27;, &#x27;underscore&#x27;, &#x27;ls&#x2F;view&#x27;, &#x27;ls&#x2F;view&#x2F;Path&#x27;, &#x27;ls&#x2F;view&#x2F;Viewport&#x27; ], 
    function ( $, step, _, view, Path, Viewport ) {
        &#x2F;**
         * Viewer is a solution for communicating the user&#x27;s current context within the application. Context in this 
         * sense refers to a set of related viewpoints. Each viewpoint has a name recognizable to the user and a unique 
         * reference to its contents.
         *
         * Viewer uses a Viewport and a Path instance for display purposes. The path shows the name and order of 
         * viewpoints in the current context; the viewport displays the contents of the viewpoints.
         * 
         * @namespace view
         * @class Viewer
         * @constructor
         * @param {Object} $el jQuery object containing the element to use as the basis for the viewer
         * @param {Object} [options] An object to use to override the default settings
         *&#x2F;
        view.Viewer = function ( $el, options ) {
            &#x2F;**
             * The configuration for the current viewer instance
             * @property _settings
             * @type {Object}
             * @private
             *&#x2F;
            this._settings = $.extend({}, view.Viewer.defaults, options);
            &#x2F;**
             * Active is a flag to capture whether the viewer is in a stable, active state and can accept commands, or 
             * in the process of changing, during which it must be deactivated.
             * @property _active
             * @type {Boolean}
             * @default true
             * @private
             *&#x2F;
            this._active = true;
            &#x2F;**
             * Viewpoints is an array of all the viewpoints loaded in the viewer with the active viewpoint on top.
             * @property _viewpoints
             * @type {Array}
             * @private
             *&#x2F;
            this._viewpoints = [];
            &#x2F;**
             * The path is a reference to the view.Path instance responsible for displaying the name of the active 
             * viewpoint and its parents.
             * @property _path
             * @type {Object}
             * @private
             *&#x2F;
            this._path = new Path($(&#x27;&lt;div&gt;&lt;&#x2F;div&gt;&#x27;).appendTo($el), options);
            &#x2F;**
             * The viewport is a reference to the LS.Viewport instance responsible for displaying the markup returned by 
             * a call to a viewpoint URL.
             * @property _viewport
             * @type {Object}
             * @private
             *&#x2F;
            this._viewport = new Viewport($(&#x27;&lt;div&gt;&lt;&#x2F;div&gt;&#x27;).appendTo($el), options);
            &#x2F;**
             * A jQuery object containing the element used as the basis for the view
             * @property _$el
             * @type {Object}
             * @private
             *&#x2F;
            this._$el = $el.addClass(&#x27;lsviewer&#x27;).data(&#x27;lsviewer&#x27;, this);
            view.Viewer.count++;
        };
        &#x2F;**
         * The number of existing Viewer instances
         * @property count
         * @type {Number}
         * @static
         *&#x2F;
        view.Viewer.count = 0;
        &#x2F;**
         * The default settings that will be used when a new viewer is created
         * @property
         * @type {Object}
         * @static
         *&#x2F;
        view.Viewer.defaults = {
            &#x2F;**
             * When removing then adding new viewpoints, the amount to pause in between.
             * @attribute delay
             * @type {Number}
             * @static
             * @default 300(ms)
             *&#x2F;
            delay: 300,
            &#x2F;**
             * The duration for a viewpoint to come into&#x2F;out of position
             * @attribute duration
             * @type {Number}
             * @static
             * @default 700(ms)
             *&#x2F;
            duration: 700,
            &#x2F;**
             * The padding to insert between entries in the path
             * @attribute pathPadding
             * @type {Number}
             * @static
             * @default 8(px)
             *&#x2F;
            pathPadding: 8,
            &#x2F;**
             * The padding to insert around screens in the viewport
             * @attribute viewportPadding
             * @type {Number}
             * @static
             * @default 8(px)
             *&#x2F;
            viewportPadding: 8,
            &#x2F;**
             * The path to the GIF animation to use when waiting for data to load in a screen
             * @attribute loadingGif
             * @type {String}
             * @static
             * @default &#x27;&#x2F;images&#x2F;ajax&#x2F;loading.gif&#x27;
             *&#x2F;
            loadingGif: &#x27;&#x2F;images&#x2F;ajax&#x2F;loading.gif&#x27;,
            &#x2F;**
             * The path to the image to use for the pointer underneath the path
             * @attribute pointerPng
             * @type {String}
             * @static
             * @default &#x27;&#x2F;js&#x2F;jquery&#x2F;plugins&#x2F;jquery.lsview.pointer.png&#x27;
             *&#x2F;
            pointerPng: &#x27;&#x2F;js&#x2F;jquery&#x2F;plugins&#x2F;jquery.lsview.pointer.png&#x27;
        };
        view.Viewer.prototype = {
            &#x2F;**
             * Activate the path and viewport, and change viewer status to active.
             * @method _activate
             * @private
             * @param {Function} [callback] A function to call once the viewer is active
             *&#x2F;
            _activate: function ( callback ) {
                var viewer = this,
                    process;
            
                process = {
                    stepsRequired: 2,
                    callback: function ( ) {
                        viewer._active = true;
                        if ( callback ) {
                            callback();
                        }
                    }
                };
                this._path.activate(step(process));
                this._viewport.activate(step(process));
            },
            &#x2F;**
             * Deactivate the path and viewport, and change viewer status to not active
             * @method _deactivate
             * @private
             * @param {Function} [callback] A function to call once the viewer is active
             *&#x2F;
            _deactivate: function ( callback ) {
                var viewer = this,
                    process;
            
                process = {
                    stepsRequired: 2,
                    callback: function ( ) {
                        viewer._active = false;
                        if ( callback ) {
                            callback();
                        }
                    }
                };
                this._path.deactivate(step(process));
                this._viewport.deactivate(step(process));
            },
            &#x2F;**
             * Add an array of viewpoints to the viewer.
             * @method _addViewpoints
             * @private
             * @param {Array} viewpoints An array of objects containing a name and a URL
             * @param {Function} [callback] A function to call once the path and viewport have finished loading the 
             * viewpoints&#x27; content
             *&#x2F;
            addViewpoints: function ( viewpoints, callback ) {
                var viewer = this,
                    viewpoint,
                    process;

                process = {
                    stepsRequired: 2,
                    callback: function ( ) {
                        viewer._viewpoints.push(viewpoint);
                        viewer.addViewpoints(viewpoints, callback);
                    }
                };
                if ( this._active ) {
                    this._deactivate();
                }
                if ( viewpoints.length ) {
                    viewpoint = viewpoints.shift();
                    this._path.push(
                        viewpoint.name,
                        function ( ) { step(process); }
                    );            
                    this._viewport.shiftLeft(
                        viewpoint.url,
                        viewpoint.data ? viewpoint.data : {},
                        function ( ) { step(process); }
                    );
                } else {
                    this._activate();
                    if ( callback ) {
                        callback();
                    }
                }
            },
            &#x2F;**
             * Remove viewpoints from the viewer.
             * @method _removeViewpoints
             * @private
             * @param {Number} numberOfViewpoints The number of viewpoints to remove from the current context
             * @param {Function} [callback] A function to call once the viewpoints have been removed and a parent 
             * viewpoint has been made active in the path and viewport
             *&#x2F;
            removeViewpoints: function ( numberOfViewpoints, callback ) {
                var viewer = this,
                    process;
             
                process = {
                    stepsRequired: 2,
                    callback: function ( ) {
                        viewer._viewpoints.pop();
                        viewer.removeViewpoints(numberOfViewpoints - 1, callback);
                    }
                };
                if ( this._active ) {
                    this._deactivate();
                }
                if ( numberOfViewpoints ) {
                    this._path.pop(function ( ) { step(process); });
                    this._viewport.shiftRight(function ( ) { step(process); });
                } else {
                    this._activate();
                    if ( callback ) {
                        callback();
                    }
                }
            },
            &#x2F;**
             * The viewpoints passed to the method will be compared with those currently loaded until a point of 
             * diversion is found. From that point on all existing viewpoints will be removed and any new viewpoints 
             * will be added.
             * @method establishContext
             * @param {Array} viewpoints An array of objects containing a name and a url
             * @param {Function} [callback] A function to call once the path and viewport have finished loading the 
             * viewpoints&#x27; content
             *&#x2F;
            replaceViewpoints: function ( viewpoints, callback ) {
                var viewer = this,
                    index = 0;

                &#x2F;&#x2F; If there are any existing viewpoints...
                if ( this._viewpoints.length ) {
                    &#x2F;&#x2F; ... compare them with the new viewpoints...
                    for ( index; index &lt; this._viewpoints.length; index++ ) {
                        &#x2F;&#x2F; ... to find the point where they diverge.
                        if ( !viewpoints[index] || viewpoints[index].url !== this._viewpoints[index].url ) { break; }
                        if ( !viewpoints[index].data || $.isEmptyObject(viewpoints[index].data ) ) {
                            if ( !($.isEmptyObject(this._viewpoints[index].data)) ) { break; }
                        } else if ( typeof viewpoints[index].data === &#x27;string&#x27; ) {
                            if ( 
                                typeof this._viewpoints[index].data !== &#x27;string&#x27; ||
                                viewpoints[index].data !== this._viewpoints[index].data 
                            ) { break; }
                        } else if ( typeof viewpoints[index].data === &#x27;object&#x27; ) {
                            if ( !(_.isEqual(viewpoints[index].data, this._viewpoints[index].data)) ) { break; }
                        }
                    }
                }    
                &#x2F;&#x2F; Remove any viewpoints beyond the point of divergence,...
                this.removeViewpoints(this._viewpoints.length - index, function ( ) {
                    &#x2F;&#x2F; ... then pause for a moment (if viewpoints were removed)...
                    setTimeout(
                        function ( ) {
                            &#x2F;&#x2F; ... before adding any new ones.
                            viewer.addViewpoints(_.rest(viewpoints, index), callback);
                        },
                        viewer._viewpoints.length - index ? viewer._settings.delay : 0
                    ); 
                });             
            },
            &#x2F;** 
             * Clean up and remove the viewer.
             * @method remove
             * @param {Function} [callback] A function to call once the viewer has been removed 
             *&#x2F;
             remove: function ( callback ) {
                var viewer = this,
                    process;

                process = {
                    stepsRequired: 2,
                    callback: function ( ) {
                        viewer._$el.removeClass(&#x27;lsviewer&#x27;).data(&#x27;lsviewer&#x27;, null);
                        view.Viewer.count--;
                        if ( callback ) {
                            callback();
                        }
                    }
                };
                this._path.remove(step(process));
                this._viewport.remove(step(process));
            }
        };
        return view.Viewer;
    }
);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
